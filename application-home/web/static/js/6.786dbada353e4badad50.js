webpackJsonp([6],{tiUO:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("STSY"),a=o("5ckB"),l=o("zL8q"),n={components:{BasePagination:a.a},data:function(){this.$createElement;return{list:[],listLoading:!0,total:0,editDialogVisible:!1,powerDialogVisible:!1,popedoms:[],rolePopedoms:[1],roleId:-1,renderFunc:function(e,t){return e("span",null,[t.label])},role:{},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:12,message:"长度在 2 到 12 个字符",trigger:"blur"}]}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0;var t=this.$refs.pageinfo.getPageParam;Object(i.b)(t).then(function(t){e.list=t.data.list,e.total=t.data.total,e.listLoading=!1})},edit:function(e){this.role=e,this.editDialogVisible=!0},saveForm:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return!1;Object(i.d)(e.role).then(function(t){e.editDialogVisible=!1,e.fetchData()})})},cancelEdit:function(){this.editDialogVisible=!1,this.$refs.editForm.resetFields()},power:function(e){var t=this;this.roleId=e.roleId,Object(i.c)(e.roleId).then(function(e){var o=0;for(t.popedoms=[],t.rolePopedoms=[],o=0;o<e.data.popedoms.length;o++){var i={};i.key=e.data.popedoms[o].popedomId,i.label=e.data.popedoms[o].name,i.remark=e.data.popedoms[o].remark,i.disabled=!1,t.popedoms.push(i)}for(o=0;o<e.data.rolePopedoms.length;o++)t.rolePopedoms.push(e.data.rolePopedoms[o].popedomId);t.powerDialogVisible=!0})},savePower:function(){var e=[],t=0;for(t=0;t<this.rolePopedoms.length;t++){var o={};o.roleId=this.roleId,o.popedomId=this.rolePopedoms[t],e.push(o)}if(0===this.rolePopedoms.length){var a={};a.roleId=this.roleId,a.popedomId=-1,e.push(a)}Object(i.e)(e).then(function(e){Object(l.Message)({message:"权限保存成功",type:"success",duration:3e3})})},addNew:function(){this.role={},this.editDialogVisible=!0},del:function(e){var t=this;l.MessageBox.confirm("确认删除次记录？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.a)(e.roleId).then(function(e){Object(l.Message)({message:"角色删除成功",type:"success",duration:3e3}),t.fetchData()})})}}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-row",{attrs:{type:"flex",justify:"end"}},[o("el-col",{attrs:{span:1}},[o("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.addNew}},[e._v("添加")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":"","max-height":"760"}},[o("el-table-column",{attrs:{label:"角色编码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.roleId)+"\n      ")]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"角色名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){e.power(t.row)}}},[e._v("分配权限")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){e.del(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("base-pagination",{ref:"pageinfo",attrs:{total:e.total},on:{change:e.fetchData}}),e._v(" "),o("el-dialog",{attrs:{title:"角色信息",visible:e.editDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.editDialogVisible=t}}},[o("el-form",{ref:"editForm",attrs:{model:e.role,rules:e.rules}},[o("el-form-item",{attrs:{label:"角色名称","label-width":"120px",prop:"name"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.cancelEdit}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.saveForm}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"权限分配",visible:e.powerDialogVisible,width:"35%",center:""},on:{"update:visible":function(t){e.powerDialogVisible=t}}},[o("el-transfer",{attrs:{filterable:"","render-content":e.renderFunc,titles:["系统权限","角色权限"],"button-texts":["到左边","到右边"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:e.popedoms},model:{value:e.rolePopedoms,callback:function(t){e.rolePopedoms=t},expression:"rolePopedoms"}},[o("el-button",{staticClass:"transfer-footer",attrs:{slot:"right-footer",type:"primary",size:"small"},on:{click:e.savePower},slot:"right-footer"},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]},r=o("VU/8")(n,s,!1,null,null,null);t.default=r.exports}});